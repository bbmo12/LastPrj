<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.last.prj.chat.service.ChatRoomMapper">

	<insert id="addChatRoom" parameterType="com.last.prj.chat.service.ChatRoomVO" useGeneratedKeys="true" keyProperty="c_no">
		<selectKey resultType="int" keyProperty="c_no" order="BEFORE">
			SELECT c_seq.nextval FROM DUAL
		</selectKey>
		INSERT INTO CHATROOM(c_no, sender_id, receiver_id, fileName, createdDate, chatReadByS, chatReadByR)
		VALUES(c_seq.nextval, #{sender_id}, #{receiver_id}, #{fileName}, #{createdDate}, #{chatReadByS}, #{chatReadByR})
	</insert>
	
	<select id="countByChatId" resultType="int">
		SELECT COUNT(*)
		FROM CHATROOM
		WHERE sender_id = #{sender_id}
		AND receiver_id = #{receiver_id}
	</select>
	
	<select id="findByChatId" resultType="com.last.prj.chat.service.ChatRoomVO">
		SELECT *
		FROM CHATROOM
		WHERE sender_id = #{sender_id}
		AND receiver_id = #{receiver_id}
	</select>
	
	<select id="getId" resultType="int">
		SELECT c_no
		FROM CHATROOM
		WHERE sender_id = #{sender_id}
		AND receiver_id = #{receiver_id}
	</select>
	
	<update id="updateFileName">
		UPDATE CHATROOM
		SET FILENAME = #{fileName}
		WHERE c_no = #{c_no}
	</update>
	
	<update id="updateChatReadS">
		UPDATE CHATROOM
		SET chatReadByS = #{chatReadByS}
		WHERE c_no = #{c_no}
	</update>
	
	<update id="updateChatReadR">
		UPDATE CHATROOM
		SET chatReadByR = #{chatReadByR}
		WHERE c_no = #{c_no}
	</update>
	
	
</mapper>